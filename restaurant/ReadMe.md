# RestFul API Restaurant
## Мавлетова Карина Радиовна, БПИ216
## Материалы, которые помогут разобраться в работе моих микросервисов (записала видео):
- как устроено изнутри: https://disk.yandex.lv/i/-hsXWpToqt2_qw
- демонстрация работы: https://disk.yandex.lv/i/rAyDPzaLp9sLOw

Для создания базы данных users:
```
create table users(
    id serial primary key,
    name varchar(20),
    email varchar(20),
    password varchar(20),
    role verchar(20)
);
```

Для создания базы данных menu:
```
create table menu(
    id serial primary key,
    dish_name varchar(20),
    price int,
    quantity int
);
```
## Критерии:
Сразу обращу внимание на то, что для каждого endpoint нужны параметры. Если их не передать, то будет выведено сообщение "Incorrect data".
### Микросервис авторизации:
#### :white_check_mark: Регистрация нового пользователя:
- Реализована конечная точка для регистрации нового пользователя. (endpoint - registration)
- Для регистрации после названия endpoint нужно передать name, email и password.
- Также есть две роли - manager и client. Если пользователь регистрируется, как manager, то помимо прочих данных нужно указать в конце пароль для менеджера. Предполагается, что обычный клиент не владеет этими данными.
- Если почта не содержит @ или пароль меньше 4 символов, то пользователь не будет зарегистрирован, ему об этом сообщат.
- Нельзя зарегистрировать пользователя с логином, который уже есть в базе данных. Будет выведено соотв. сообщение.
- Если пользователь зарегистрирован, то он об этом узнает.
#### :white_check_mark: Авторизация пользователя:
- Для входа в систему пользователю после endpoint (authorization) необходимо указать пароль и email.
- Если пользователь до этого не был зарегистрирован, то войти он не сможет и получит соов. сообщение.
- В случае ввода неудачного пароля - пользователь будет оповещён об этом.
- Если он вошёл успешно, то об этом тоже будет сказано.

#### :white_check_mark: Предоставление информации о пользователе:
- Чтобы получить информацию о пользователе нужно указать /id.
- Если пользователя с таким id нет, то будет возвращено соотв. сообщение
- Иначе будет выведено id и name пользователя
#### :white_check_mark: База данных, хранящая информацию о пользователях:
- Называется она users
- Хранит id, name, email, password, role для каждого отдельного пользователя.

### Микросервис обработки заказов:
Для начала скажу - чтобы пользователи могли заказывать что-то, а также взаимодействовать с рестораном - им следует войти в систему. 
Т.е нужно обязательно авторизоваться (без регистрации авторизация будет недоступна)
Моя программа реализована таким образом, что существует статический список авторизованных пользователей. Т.е запускаетяс сервер, начинается сессия, где пользователи взаимодействуют с рестораном в случае успешной авторизации.
Если сервер отключить, а затем запустить заново, то нужно будет повторно авторизоваться.
При обращении к определённому endpoint ресторана - нужно дополнительно указывать email, чтобы была возможность проверить, что пользователь авторизован на данный момент.

#### :white_check_mark: Создание заказа:
- Чтобы создать заказ - нужно передать свой email и название блюда по endpoint order
В каких случаях не будет обработан заказ (для каждого случая пользователь получит соотв. сообщение):
  - Если пользователь не авторизован
  - Если указанного блюда не существует
  - Если указанное блюдо закончилось
В случае успешного заказа - пользователю сообщат информацию о нём, включая Id, который далее можно использователь для отслеживания статуса заказа

#### :white_check_mark: Обработка заказа:
Я сделала следующим образом: у каждого заказа при создании статус - 0 (не готов). При первом запросе пользователя о состоянии заказа - его статус меняется на выполнен.

#### :white_check_mark: Предоставление информации о заказе:
Каждому заказу присваивается уникальный id, который сообщается пользователю в случае успешного создания заказа. Получить информацию можно по endpoint orderInfo, передав email и id
Случаи, когда не будет получено информации:
- Пользователь не авторизован
- Заказа с таким id не существует

#### :white_check_mark:Управление блюдами:
Управлять блюдами может только пользователь с правами менеджера.
Для управления доступны:
- Получение полной информации по меню, которая доп. содержит кол-во оставшихся блюд. Для этого нужно по endpoint countDishes передать email. Если email принадлежит не менеджеру, то будет выведно сообщение о невозможности предоставления соотв. информации.Также если пользователь не авторизован - он не получит информацию.
- Также можно добавить блюда, в случае если какие-то закончились. Для этого нужно передать email, id блюда и новое кол-во по endpoint add.
   Не получится это сделать если:
     - Блюда с таким id нет
     - Пользователь не авторизован
     - Пользователь не является менеджером
     
#### :white_check_mark:Предоставление меню:
Доступ к неполному меню (без количества оставшихся блюд) есть у каждого авторизованного пользователя по endpoint menu.

 




 

